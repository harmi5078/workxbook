<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>汇款记录表--系统支付明细核对</title>  
<link href="../bootstrap/5.1.1/bootstrap.min.css" rel="stylesheet">  
<script src="../bootstrap/5.1.1/bootstrap.bundle.min.js"></script>  
<script src="../js/vue.global.js"></script>
<script src="../js/axios.min.js"></script>
<script src="js_txnav.js?asdd"></script>
<script src="js_txcommon.js"></script> 
<link href="css_txworks.css" rel="stylesheet"> 

</head>
<body >

<div id="startmenu" style="z-index:88;"></div> 
<div id = "app" onmousedown="closeNav()" style="z-index: 8;"> 	
	
<div class="tx_topLev2"  > </div> 

<div   id="maindiv"  class="tx_oneframe"  
onmousedown="closeNav()" 
style="font-family: 宋体; background-color: aliceblue;"> 

<div class="tx_onerow" style="width: 86.5%;position: fixed;background-color: aliceblue;border: var(--cell-boder );">  
	<div   class="tx_acccheckheader" style="margin-top:20px ;" >	 
			 泰湘汇款支付数据核对表
	</div>
	<div class="tx_onerow  " style="width: 100% ;margin-bottom: 3px;"> 	 
		  
		<div   style="width: 23% ">
			 
				<div class="tx_acheckgroup"> 
									<div class="tx_achckname"> 起始日期：</div> 
									<div class="tx_acheckvalue"> 
										<input type="date" @change="reloadData()" v-model="startTime"  class="tx_titleDateLabel  " placeholder="支付时间" 
					 min="2020-01-01" max="2025-12-31">  </div>
				 </div> 
		</div >	 
		<div  style="width: 23% "> 
				<div class="tx_acheckgroup"> 
									<div class="tx_achckname"> 截止日期：</div> 
									<div class="tx_acheckvalue"><input type="date" @change="reloadData()" v-model="endTime"  class="tx_titleDateLabel" placeholder="支付时间" 
					 min="2020-01-01" max="2025-12-31">  </div>
				 </div> 
		</div >	   
	</div >	      

	<div class="tx_onerow " style="font-weight: bold;width: 100%;border-top: var(--cell-boder );" >
		    <div style="width: 8%;padding-left:8px;" @click="orderDataByDate()">日期 
				<i id="dateOrderType" class=" "></i> </div >
			<div style="width: 22%;padding-left:8px;color: rgb(128, 0, 64);" class="tx_cellboder_left ">收入(系统) </div >	 
			<div style="width: 22%;padding-left:8px;color: rgb(128, 0, 64);" class="tx_cellboder_left">收入(记录表) </div >	 	
			<div style="width: 22%;padding-left:8px;color: rgb(0, 81, 162);" class="tx_cellboder_left">支出(系统)</div >	
			<div style="width: 22%;padding-left:8px;color: rgb(0, 81, 162);" class="tx_cellboder_left">支出(记录表)</div > 
			<div style="width: 4%; "  > </div > 
	</div> 
</div >

<div class="tx_onerow" style="width: 86.5%;bottom: 27px;position: fixed;background-color: aliceblue;border: var(--cell-boder );z-index: 1666;">  
	<div class="tx_onerow " style="font-weight: bold;width: 100%;" >
    <div style="width: 8%;padding-left:8px;"  >合计  </div >
	<div style="width: 22%;padding-left:8px;color: rgb(128, 0, 64);" class="tx_cellboder_left ">{{billTMyi}} </div >	 
	<div style="width: 22%;padding-left:8px;color: rgb(128, 0, 64);" class="tx_cellboder_left">{{billTTai}} </div >	 	
	<div style="width: 22%;padding-left:8px;color: rgb(0, 81, 162);" class="tx_cellboder_left">{{billTMyo}}</div >	
	<div style="width: 22%;padding-left:8px;color: rgb(0, 81, 162);" class="tx_cellboder_left">{{billTTao}}</div > 
	<div style="width: 4%; "  > </div > 
	</div> 
</div >
 
<div style="margin-top: 117px;"> 

	<div class="tx_onerow  tx_rowcellboder tx_tab_row" v-for="(item,index) in accCheckList"  > 
		<div style="width: 8%;padding-left:8px;cursor: pointer;"  > <a @click="showBillList(item)" data-bs-toggle="modal"  data-bs-target="#myModal" >{{item.key}}</a> </div >
		<div style="width: 22%;padding-left:8px; color: rgb(128, 0, 64);font-weight: bold;" class="tx_cellboder_left"  >  <span v-if="item.reportData.myiAmt>0">{{formatAmt(item.reportData.myiAmt)}} </span></a> </div >	 
		<div style="width: 22%;padding-left:8px;color: rgb(128, 0, 0);font-weight: bold;" class="tx_cellboder_left"><span v-if="item.reportData.taiAmt>0"> {{formatAmt(item.reportData.taiAmt)}}</span></div >	 	
		<div style="width: 22%;padding-left:8px; color: rgb(0, 81, 162);" class="tx_cellboder_left"  ><span v-if="item.reportData.myoAmt>0"> {{formatAmt(item.reportData.myoAmt )}}</span></div >	
		<div style="width: 22%;padding-left:8px; color: rgb(0, 81, 162);" class="tx_cellboder_left">  <span v-if="item.reportData.taoAmt>0">  {{formatAmt(item.reportData.taoAmt)}}</span>  </div >
		<div style="width: 4%;" >   
			 <a @click="showBillList(item)" 
			 data-bs-toggle="modal"  
			 data-bs-target="#myModal"  
			 v-if="(item.reportData.myoAmt!=item.reportData.taoAmt || item.reportData.myiAmt!=item.reportData.taiAmt)" 
			  >  
			 	<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-info-circle-fill" viewBox="0 0 16 16">
  					<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.496 6.033h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286a.237.237 0 0 0 .241.247zm2.325 6.443c.61 0 1.029-.394 1.029-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94 0 .533.425.927 1.01.927z"/>
  				</svg>   
			 </a> 
		</div >	  
	</div>  
</div>			
<div class="tx_onerow "  style="border-top: var(--cell-boder );border-left: var(--cell-boder );border-right: var(--cell-boder );" >
	    <div style="width: 8%;" > &emsp;</div >
		<div style="width: 10%;"  ></div >	 
		<div style="width: 10%;" ></div >	 	
		<div style="width: 10%;"  ></div >	
		<div style="width: 10%;"  ></div >	  
		<div style="width: 25%;"  ></div >	 
		<div style="width: 25%;"  ></div > 
</div> 	
<div class="tx_onerow "  style="border-top: var(--cell-boder );border-left: var(--cell-boder );border-right: var(--cell-boder );" >
	    <div style="width: 8%;" > &emsp;</div >
		<div style="width: 10%;"  ></div >	 
		<div style="width: 10%;" ></div >	 	
		<div style="width: 10%;"  ></div >	
		<div style="width: 10%;"  ></div >	  
		<div style="width: 25%;"  ></div >	 
		<div style="width: 25%;"  ></div > 
</div> 		 
 	
		  
</div>
 
   
<!-- 模态框 -->
<div class="modal" id="myModal">
  <div class="modal-dialog tx_modal_dlg">
    <div class="modal-content">

      <!-- 模态框头部 -->
      <div class="tx_modal_header">
        <h4 class="modal-title">{{modelTitle}}</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <!-- 模态框内容 -->
      <div class="tx_modal_body">
        <div class="container mt-3">
			 
  			<div    class="tx_onerow  tx_rowcellboder tx_tab_row"   > 
				<div style="width: 50%;"  >系统数据 </div >	 
				<div style="width: 50%;"  class="tx_cellboder_left"> 文件数据 </div >	  
			</div> 	 
			<div v-for="(item,index) in billsSys"   class="tx_onerow  tx_rowcellboder tx_tab_row"   > 
				<div style="width: 15%;"  >{{item.payAmt}}</div >	
				<div style="width: 35%;"  class="tx_cellboder_left"> {{item.remark}}  </div >
				
				<div style="width: 15%;"  class="tx_cellboder_left">{{billsFile[index].payAmt}}</div >	
				<div style="width: 35%;"  class="tx_cellboder_left"> {{billsFile[index].remark}}  </div >	  
			</div> 	
			     
			 	
			
			<div class="tx_onerow "  style="border-top: var(--cell-boder );  " >
				    <div style="width: 80%;" > &emsp;</div >
					<div style="width: 10%;"  ></div >	 
					<div style="width: 10%;" ></div >	 	
					 
			</div> 		
		</div>
      </div>
 

    </div>
  </div>
</div>

 
 
    
</div>       
</body>
<script>
	



const app = {
	data() {
		return {
		  accCheckList : [] ,	 
		  startmenuHtml : getStartMenuHtml_fb() ,  
		  startTime:'',
		  endTime:'' ,  
		  orderDate:0  ,
		  modelTitle:"",
		  billsSys:[],
		  billsFile:[],
		  billTMyi:0,
		  billTMyo:0,
		  billTTai:0,
		  billTTao:0
		  
		}
	},
	mounted () {
		  
		this.endTime = getDate()   
		this.startTime = "2021-11-09"  
		  
		const params = {  
			startTime:this.startTime,
			endTime:this.endTime,
			pageSize:500
		 }	
			
		this.loadData(params,false) 
		 
              
	},
	methods: {  
		reloadData()
		{
			orderDateField = ""
			if(this.orderDate==2)
			{
				orderDateField = " acc.paytime "
			}else{
				orderDateField = " acc.paytime desc "
			}
			const params = {  
				startTime:this.startTime,
				endTime:this.endTime, 
				pageSize:500,
				orderField:orderDateField
			 }	
			
			this.loadData(params,false) 
		
		},
		loadData(params,paged) { 
			
			  axios
			  .get('/getcheckbills',{params:params})
			  .then(response => { 
				  this.accCheckList = response.data.reObject 
				  
				  this.billTMyi = this.formatAmt(response.data.reportData["billTMyi"])
				  this.billTMyo = this.formatAmt(response.data.reportData["billTMyo"])
				  this.billTTai = this.formatAmt(response.data.reportData["billTTai"])
				  this.billTTao = this.formatAmt(response.data.reportData["billTTao"])
				   
			  })
			  .catch(function (error) { // 请求失败处理
				 
			});
		}  ,
		formatAmt(amt)
		{
			return formatNumber(amt)
		} ,
		convertAmt(amt)
		{
			return convertCurrency(amt) 
		},
		orderDataByDate()
		{
			var div = document.getElementById("dateOrderType"); 
			if(this.orderDate==0 || this.orderDate==1)
			{
				this.orderDate=2
				div.className = "tx_icon_orderup"; 
			}
			else if(this.orderDate==2){
				this.orderDate=1
				div.className = "tx_icon_orderdown"; 
			}
			
			this.reloadData(); 
		},
		showBillList(item)
		{
			this.modelTitle = item.key
			this.billsSys = item.list 
			this.billsFile = item.object 
		}
	  } 
}
 
vm = Vue.createApp(app).mount('#app');
  
</script>

  
</body>
</html>